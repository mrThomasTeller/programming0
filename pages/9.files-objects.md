---
layout: page
title: "9. Работа с объектами и файлами"
---

## Объекты

```js
let cat = {
  name: "Мурка",
  color: "black",
  age: 4,
};

// cat - это объект, у объекта есть свойства, которые перечисляются через запятую. У нашего кода имя - "Мурка", он чёрного цвета и ему 4 года.

// к этим свойствам можно обратиться
console.log(cat.name); // выведет "Мурка"
console.log(cat.age); // выведет 4

if (cat.age < 1) {
  console.log("Котик ещё совсем маленький");
}

// можно изменить свойство объекта
cat.name = "Барсик"; // извини кот, тебя переименовали

// также объекты можно хранить в массиве. Вот массив с тремя котами:
let cats = [
  {
    name: "Мурка",
    age: 4,
    color: "black",
  },
  {
    name: "Сеня",
    age: 0,
    color: "white",
  },
  {
    name: "Рикардо",
    age: 9,
    color: "orange",
  },
];

console.log(cats[1].color); // цвет второго кота - white

// можно добавить ещё одного кота в массив
cats.push({
  name: "Нюра",
  age: 2,
  color: "brown",
});
```

## Файлы

Чтобы работать с файлами нам нужно подключить стандартную библиотеку `fs`. Стандартная - значит, что нам не нужно её устанавливать, она уже идёт вместе с NodeJS.

```js
const fs = require("fs");

// мы можем записать в файл cats.json наш массив с котами таким образом
fs.writeFileSync("cats.json", JSON.stringify(cats));

// а так можно прочитать массив с котами из файла cats.json
let cats2 = JSON.parse(fs.readFileSync("cats.json"));
```

Функция `JSON.stringify` сериализует любые данные, то есть превращает их в строку. То есть на вход ей можно дать объект, массив, число и т.п., а на выходе мы получим строку. Так как в файл можно сохранять только строки, то мы использовали эту функцию, чтобы записать в файл наш массив с котами.

Функция `JSON.parse` делает обратную операцию - переводит строку с сериализованными в ней данными в объект, массив, число и т.п.

## Задания в классе

---

_**Задание в классе 1**_

Создать и сохранить в файл список книг

---

_**Задание в классе 2**_

Вывести список книг

---

_**Задание в классе 3**_

Прочитать список книг, пометить первую непрочитанную книгу как прочитанную, записать его обратно

---

_**Задание в классе 4**_

1. Спросить у пользователя название и год новой книги
2. Прочиатать список книг
3. Удалить самую старую книгу
4. Добавить новую
5. Записать его обратно

---

## Домашнее задание

Теперь вам предстоит сделать несколько программ, которые будут работать со списком задач: создавать, отображать, пополнять его, помечать задачи как выполненные, удалять задачи, очищать от уже выполненных, выполнять поиск по списку задач и сортировать его.

---

_**Задание 9.1 init**_

Нужно записать в файл todos.json список таких дел (либо можете записать другие дела, которые придумаете):

- feed cat (выполнено)
- buy products (не выполнено)
- watch TV (не выполнено)

Объект, в котором храниться одно дело выглядит так:

```js
{
  title: "feed cat", // название дела
  completed: true, // true - выполнено, false - не выполнено
}
```

Список дел - это массив таких объектов.

Напишите программу, которая записывает в файл `todos.json` массив таких объектов.

---

_**Задание 9.2 list-all**_

Напишите программу, которая выводит список дел из файла `todos.json` в таком формате:

```
[x] 1. feed cat
[ ] 2. buy products
[ ] 3. watch TV
```

`[x]` - означает, что дело выполнено, `[ ]` - не выполнено.

---

_**Задание 9.3 list**_

Напишите программу, которая выводит список только невыполненных дел из файла `todos.json`:

```
1. buy products
2. watch TV
```

Обратите внимание, нумерация дел остаётся такая как если бы вы выводили все дела. То есть пункт `1. feed cat` просто скрыт.

---

_**Задание 9.4 list-completed**_

Напишите программу, которая выводит список только выполненных дел из файла `todos.json`:

```
1. feed cat
```

---

_**Задание 9.5 add**_

Программа должна:

1. Спросить пользователя какое дело он хочет добавить
2. Прочитать список уже существующих дел из файла `todos.json`
3. Добавить в этот список дело, которое добавил пользователь, при этом флаг `completed` должен быть равен `false`
4. Записать дополненный список обратно в файл `todos.json`
5. Вывести сообщение "done!" (сделно!)

```
todo?
> play computer game
done!
```

---

_**Задание 9.6 toggle**_

Программа должна:

1. Спросить пользователя порядковый номер дела, которое нужно пометить как выполненное
2. Прочитать список дел из файла `todos.json`
3. Если есть дело с таким номером то:
   1. изменить флаг `completed` дела на противоположный (с `false` на `true` и наоборот)
   2. Записать изменённый список обратно в файл `todos.json`
   3. Вывести дело в формате "[x] 1. feed cat"
4. Если такого дела нет, то вывести сообщение "wrong number" (неправильный номер)

```
toggle?
> 2
[x] 2. buy products
```

```
toggle?
> 4
wrong number
```

---

_**Задание 9.7 remove**_

Программа должна:

1. Спросить пользователя порядковый номер дела, которое нужно удалить из списка
2. Прочитать список дел из файла `todos.json`
3. Если есть дело с таким номером то:
   1. удалить дело из списка при помощи метода массива `splice`
   2. Записать изменённый список обратно в файл `todos.json`
   3. Вывести сообщение "done!"
4. Если такого дела нет, то вывести сообщение "wrong number" (неправильный номер)

```
remove?
> 2
done!
```

```
remove?
> 4
wrong number
```

Метод splice работает таким образом:

```js
let a = ["one", "two", "three", "four", "five"];
a.splice(2, 1); // удалит из массива 1 элемент начиная с элемента с индексом 2 (то есть удалит из этого массива 'three')
console.log(a); // выведет ['one', 'two', 'four', 'five']
```

---

_**Задание 9.8 clear**_

Программа должна:

1. Прочитать список дел из файла `todos.json`
2. Сформировать новый массив, из которого будут удалены все выполненные дела
3. Записать новый список в файл `todos.json`
4. Вывести сообщение "{x} todos removed" ({x} дел удалено), где `{x}` - это количество удалённых из списка дел

```
1 todos removed
```

---

_**Задание 9.9\* search**_

Программа должна:

1. Спросить у пользователя строку для поиска
2. Прочитать список дел из файла `todos.json`
3. Найти те дела, в которые входит данная строка (поиск должен быть регистронезависимым, то есть подстрока "abc" должна быть найдена и в деле "abcde" и в деле "ABcde")
4. Вывести список дел, при том найденная подстрока должна быть выведена красным цветом
5. Если ни одного дела не найдено, то вывести сообщение "no matched todos" (нет соответствующих дел)

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>search?
> at
[x] 1. feed c<span style="color: red">at</span>
[ ] 3. w<span style="color: red">at</span>ch TV
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>search?
> tv
[ ] 3. watch <span style="color: red">TV</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>search?
> my
no matched todos
</code></pre></div></div>

Для изменения цвета текста используйте библиотеку chalk. Для этого установите эту библиотеку:

```
npm i chalk --save
```

Для того, чтобы окрасить текст в красный:

```js
console.log("Этот текст обычный, " + chalk.red("а этот текст будет красным"));
```

---

_**Задание 9.10\* sort**_

Программа должна:

1. Прочитать список дел из файла `todos.json`
2. Отсортировать список дел при помощи метода массива sort таким образом: сначала идёт список невыполненных дел по алфавиту, затем идёт список выполненных дел по алфавиту
3. Записать отсортированный список в файл `todos.json`
4. Вывести отсортированный список дел

```
[ ] 1. buy products
[ ] 2. watch TV
[x] 3. feed cat
```

Примеры использования метода массива sort, смотрите здесь https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/sort

---
